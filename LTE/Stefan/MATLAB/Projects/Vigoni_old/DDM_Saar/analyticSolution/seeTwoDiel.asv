N = 151;
er1max=9;
er2max=9;
a = 22.86;
b = 10.16;
d1 = 15;
d2 = 5;
d3 = 5;
mr1 = 1;
mr2 = mr1;

f=11;

for i=1:N
    for j=1:N
        er1(i,j) = (er1max-1)*(i-1)/(N-1)+1;
        er2(i,j) = (er2max-1)*(j-1)/(N-1)+1;
        G(j,i) = analytic(a,b,d1,d2,d3,er1(i,j),mr1,er2(i,j),mr2,f);
    end
end

%subplot(1,2,1);
surf (er,mr,abs(G));
shading('interp');
view([0,90]);
xlabel('\mu_r');
ylabel('\epsilon_r');
