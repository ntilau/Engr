function y = applyMultOp(A, fact, b)
% A is a matrix
% fact is a factorization structure of matrix X with 
% fact.P * X * fact.Q = fact.L * fact.U
% b is a vector
% y = A*fact^{-1}*b

if isempty(fact)
  y = A*b;
else
  if ~isempty(fact.P)
    y = fact.P*b;
  end
  y = fact.U\(fact.L\y);
  if ~isempty(fact.Q)
    y = fact.Q*y;
  end
  y = A*y;
end
