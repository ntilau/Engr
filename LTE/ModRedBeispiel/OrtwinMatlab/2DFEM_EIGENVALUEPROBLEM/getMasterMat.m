%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Master Matrices
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
function [S, T, Sa, Sb, Sc, Tmaster] = getMasterMat(project, order)

% initialize stiffness matrices Sa, Sb, Sc
if order == 1  
    
    % initialize system matrix
    S = sparse(project.nodeDim, project.nodeDim) ;
    T = sparse(project.nodeDim, project.nodeDim) ;
    
    % master stiffness matrix
    Sa = 0.5 * [ 1  0 -1 ; 0  0  0  ; -1  0  1] ;
    Sb = 0.5 * [ 0  1 -1 ; 1  0 -1  ; -1 -1  2] ;
    Sc = 0.5 * [ 0  0  0 ; 0  1 -1  ;  0 -1  1] ;
    
    % master mass matrix
    Tmaster = 1/24 * [2 1 1 ; 1 2 1 ; 1 1 2] ;

elseif order == 2
    
    % initialize system matrix
    S = sparse(project.nodeDim+project.edgeDim, project.nodeDim+project.edgeDim) ;
    T = sparse(project.nodeDim+project.edgeDim, project.nodeDim+project.edgeDim) ;
    
    % master stiffness matrix
    Sa = 1/6*[ 3  0  1  0  0 -4;...
               0  0  0  0  0  0;...
               1  0  3  0  0 -4;...
               0  0  0  8 -8  0;...
               0  0  0 -8  8  0;...
              -4  0 -4  0  0  8 ] ;
    Sb = 1/6*[ 0 -1  1  4  0 -4;...
              -1  0  1  4 -4  0;...
               1  1  6  0 -4 -4;...
               4  4  0  8 -8 -8;...
               0 -4 -4 -8  8  8;...
              -4  0 -4 -8  8  8 ] ;
    Sc = 1/6*[ 0  0  0  0  0  0;...
               0  3  1  0 -4  0;...
               0  1  3  0 -4  0;...
               0  0  0  8  0 -8;...
               0 -4 -4  0  8  0;...
               0  0  0 -8  0  8 ] ;
    
    % master mass matrix
    Tmaster = 1/360 * [ 6 -1 -1  0 -4  0;...
                       -1  6 -1  0  0 -4;...
                       -1 -1  6 -4  0  0;...
                        0  0 -4 32 16 16;...
                       -4  0  0 16 32 16;...
                        0 -4  0 16 16 32 ] ;
    
else
    printf('please choose order 1 or 2...\n') ;
    
end %endif